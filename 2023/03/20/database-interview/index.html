
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>database -interview | Waiting for the dawn</title>
        <meta name="author" content="Yanxin Xiang">
        <meta name="description" content="">
        <meta name="keywords" content="">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
        <link rel="icon" href="https://i.ibb.co/sszdSW8/IMG-2691.jpg">
        <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script>
        <script src="https://cdn.staticfile.org/highlight.js/11.7.0/highlight.min.js"></script>
        <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/11.7.0/styles/github.min.css">
        <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css">
        
        <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
        
        
        <script src="https://cdn.staticfile.org/KaTeX/0.16.4/katex.min.js"></script>
        <script src="https://cdn.staticfile.org/KaTeX/0.16.4/contrib/auto-render.min.js"></script>
        <link rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.16.4/katex.min.css">
        
        
        <link rel="stylesheet" href="/css/fonts.min.css">
        <link rel="stylesheet" href="/css/particlex.css">
    <meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <div id="loading" style="height: 100vh; width: 100vw; left: 0; top: 0; position: fixed; display: flex; z-index: 2147483647; background: #fff; transition: opacity 0.3s ease-out; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; pointer-events: none">
    <div style="width: 50vmin; height: 50vmin; margin: auto; padding: 50px; border-radius: 50%; display: flex; border: solid 10px #a3ddfb">
        <div style="margin: auto; text-align: center">
            <h2>LOADING</h2>
            <p>加载过慢请开启缓存，浏览器默认开启</p>
            <img src="/images/loading.gif" style="height: 50px; border-radius: 0">
        </div>
    </div>
</div>

        <div id="layout">
            <transition name="into">
            <div id="main" v-show="showpage" style="display: -not-none">
                <nav id="menu">
    <div class="desktop-menu">
        <a class="title" href="/">
            <span>WAITING FOR THE DAWN</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </div>
    <div :class="&quot;phone-menu &quot; + menushow" id="phone-menu">
        <div class="curtain" @click="menushow = !menushow" v-show="menushow"></div>
        <div class="title" @click="menushow = !menushow">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;WAITING FOR THE DAWN</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="menushow">
            
            <a href="/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>database -interview </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/3/20
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            <span class="tag">
                
                <a href="/tags/database/" style="color: #03a9f4">database</a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/categories/" style="color: #03a9f4">categories</a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <h2 id="分类"><a href="#分类" class="headerlink" title="分类"></a>分类</h2><div class="table-container">
<table>
<thead>
<tr>
<th>分类</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td>OLTP(Online Transaction Processing)</td>
<td></td>
</tr>
<tr>
<td>OLAP(Online Analytical Processing)</td>
</tr>
</tbody>
</table>
</div>
<p>HTAP<br>HTAP是Hybrid Transactional/Analytical Processing的缩写，意为混合事务/分析处理。传统的OLTP（Online Transactional Processing）和OLAP（Online Analytical Processing）系统是分离的，需要在不同的系统中进行操作和管理，而HTAP则将事务处理和分析处理的功能融合在一起。</p>
<p>在HTAP系统中，事务处理和分析处理使用的是同一套数据，因此需要保证数据的一致性和可靠性。为了实现这一点，HTAP系统通常采用以下几种技术：</p>
<p>内存数据库：内存数据库可以提高数据的读写速度，使得HTAP系统可以快速地进行事务处理和分析处理。<br>分布式架构：HTAP系统通常采用分布式架构，将数据分散存储在多个节点中，可以提高系统的可靠性和容错性。<br>实时数据同步：HTAP系统需要保证数据的一致性，因此需要使用实时数据同步技术，将事务处理和分析处理使用的数据保持同步。<br>查询优化：HTAP系统需要支持复杂的查询操作，因此需要使用查询优化技术来提高查询的效率和性能。</p>
<h2 id="redis和mysql的数据一致性问题"><a href="#redis和mysql的数据一致性问题" class="headerlink" title="redis和mysql的数据一致性问题"></a>redis和mysql的数据一致性问题</h2><p>随着业务量的增长，项目请求量越来越大，如果每次都从数据库中读取数据，那么肯定会有性能问题。</p>
<p>这个阶段通常的做法是，引入「缓存」来提高读性能，架构模型就变成了这样：</p>
<p><img src="https://kaito-blog-1253469779.cos.ap-beijing.myqcloud.com/2021/09/16310431074028.jpg" alt="avator"></p>
<p>但是这样可能会有一些问题，比如数据一致性的问题，有这样几种方案用于解决</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>方式</th>
<th>特点</th>
<th>缺点</th>
<th>优点</th>
</tr>
</thead>
<tbody>
<tr>
<td>主动更新(双写策略)</td>
<td>数据库更新后立刻更新缓存</td>
<td>会增加数据库的负担</td>
<td>能保证数据的一致性</td>
</tr>
<tr>
<td>延迟更新</td>
<td>数据库更新后，不立即更新缓存，等待缓存过期时再更新</td>
<td>可能导致缓存中数据不一致</td>
<td>减少数据库负担</td>
</tr>
<tr>
<td>消息队列</td>
<td>数据库更新的时候，通过消息队列等方式通知缓存更新，确保缓存和数据库中的数据一致</td>
<td>需要额外的管理和维护工作</td>
<td>减少对库的压力</td>
</tr>
</tbody>
</table>
</div>
<h2 id="数据库高性能方案"><a href="#数据库高性能方案" class="headerlink" title="数据库高性能方案"></a>数据库高性能方案</h2><p>设计一个能扛住千万并发的数据库架构</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>层面</th>
<th>方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>数据库层面</td>
<td>1.设置mysql的最大连接数<br>2.使用redis缓存<br>3.分库分表<br>4.读写分离<br>5.不同类型采用不同的数据库<br>5.池化技术，比如连接池</td>
</tr>
<tr>
<td>磁盘访问</td>
<td>1.磁盘的页缓存<br>2.尽量顺序读写<br>3.SSD<br>4.频繁读写一块区间的时候<br>5.频繁读写同一块磁盘区域的时候，可以使用mmap代替read/write<br>6.在需要同步写的场景中，尽量将写请求合并，而不是让每个请求都同步写入磁盘，即可以用 fsync() 取代 O_SYNC</td>
</tr>
<tr>
<td>把架构异步化</td>
<td>1.多线程<br>2.消息队列</td>
</tr>
</tbody>
</table>
</div>

    </div>
    
    
    
    
    
    
    
</div>

                <footer id="footer">
    <div class="footer-wrap">
        <div>
            &copy;
            2022 - 2023 Waiting for the dawn
            <span class="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Yanxin Xiang
        </div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp; <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a></div>
        
    </div>
</footer>

            </div>
            </transition>
            <div id="showimg">
                <img id="showimg-content">
            </div>
        </div>
        <script src="/js/functions.js"></script>
<script src="/js/particlex.js"></script>







    </body>
</html>
