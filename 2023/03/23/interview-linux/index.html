
<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>interview - linux | Waiting for the dawn</title>
        <meta name="author" content="Yanxin Xiang">
        <meta name="description" content="">
        <meta name="keywords" content="">
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0">
        <link rel="icon" href="https://i.ibb.co/sszdSW8/IMG-2691.jpg">
        <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script>
        <script src="https://cdn.staticfile.org/highlight.js/11.7.0/highlight.min.js"></script>
        <link rel="stylesheet" href="https://cdn.staticfile.org/highlight.js/11.7.0/styles/github.min.css">
        <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css">
        
        <script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>
        
        
        <script src="https://cdn.staticfile.org/KaTeX/0.16.4/katex.min.js"></script>
        <script src="https://cdn.staticfile.org/KaTeX/0.16.4/contrib/auto-render.min.js"></script>
        <link rel="stylesheet" href="https://cdn.staticfile.org/KaTeX/0.16.4/katex.min.css">
        
        
        <link rel="stylesheet" href="/css/fonts.min.css">
        <link rel="stylesheet" href="/css/particlex.css">
    <meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <div id="loading" style="height: 100vh; width: 100vw; left: 0; top: 0; position: fixed; display: flex; z-index: 2147483647; background: #fff; transition: opacity 0.3s ease-out; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; pointer-events: none">
    <div style="width: 50vmin; height: 50vmin; margin: auto; padding: 50px; border-radius: 50%; display: flex; border: solid 10px #a3ddfb">
        <div style="margin: auto; text-align: center">
            <h2>LOADING</h2>
            <p>加载过慢请开启缓存，浏览器默认开启</p>
            <img src="/images/loading.gif" style="height: 50px; border-radius: 0">
        </div>
    </div>
</div>

        <div id="layout">
            <transition name="into">
            <div id="main" v-show="showpage" style="display: -not-none">
                <nav id="menu">
    <div class="desktop-menu">
        <a class="title" href="/">
            <span>WAITING FOR THE DAWN</span>
        </a>
        
        <a href="/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
    </div>
    <div :class="&quot;phone-menu &quot; + menushow" id="phone-menu">
        <div class="curtain" @click="menushow = !menushow" v-show="menushow"></div>
        <div class="title" @click="menushow = !menushow">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;WAITING FOR THE DAWN</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="menushow">
            
            <a href="/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>interview - linux </h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/3/23
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            <span class="tag">
                
                <a href="/tags/interview/" style="color: #03a9f4">interview</a>
            </span>
            
            <span class="tag">
                
                <a href="/tags/linux/" style="color: #00bcd4">linux</a>
            </span>
            
        </span>
        
    </div>
    
    <div class="content" v-pre>
        <h2 id="linux-读写文件的过程"><a href="#linux-读写文件的过程" class="headerlink" title="linux 读写文件的过程"></a>linux 读写文件的过程</h2><p>清楚一点，linux的进程里维护了一张当前已经打开的文件描述符表</p>
<p>而系统维护了另外两张表:</p>
<p>1.打开文件表</p>
<p>2.inode表</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>类型</th>
<th>过程</th>
</tr>
</thead>
<tbody>
<tr>
<td>读文件</td>
<td>1.进程调用库函数向内核发起读文件请求<br>2.内核通过检查进程的文件描述符定位到虚拟文件系统的已打开文件列表表项<br>3.调用该函数的可用系统调用函数read()<br>4.read()函数通过文件表项链接到目录项模块，根据传入的文件路径，在目录项模块中检索，找到该文件的inode<br>5.在inode中，根据文件内容偏移量计算出要读取的页<br>6.通过inode找到文件对应的address_space<br>7.在address_space中访问该文件的页缓存树，查找对应的页缓存节点,若页缓存命中，那么直接返回文件内容，若丢失，那么就是缺页一场，创建一个页缓存页，然后通过inode找到对应的磁盘地址，读入内存</td>
</tr>
<tr>
<td>写文件</td>
<td>前5步和读一致<br>如果页缓存命中，直接把文件内容修改更新在页缓存的页中。写文件就结束了。这时候文件修改位于页缓存，并没有写回到磁盘文件中去；<br>如果页缓存缺失，那么产生一个页缺失异常，创建一个页缓存页，同时通过inode找到文件该页的磁盘地址，读取相应的页填充该缓存页。此时缓存页命中，进行第6步。<br>一个页缓存中的页如果被修改，那么会被标记成脏页。脏页需要写回到磁盘中的文件块。有两种方式可以把脏页写回磁盘：1）手动调用sync()或者fsync()系统调用把脏页写回<br>（2）pdflush进程会定时把脏页写回到磁盘<br>同时注意，脏页不能被置换出内存，如果脏页正在被写回，那么会被设置写回标记，这时候该页就被上锁，其他写请求被阻塞直到锁释放。</td>
</tr>
</tbody>
</table>
</div>
<h2 id="kill-9-和kill-15的区别"><a href="#kill-9-和kill-15的区别" class="headerlink" title="kill 9 和kill 15的区别"></a>kill 9 和kill 15的区别</h2><p>kill -9会强制终止进程，无论进程是否愿意终止，它会立即杀死进程并释放资源。这是一种非常强硬的方法，可能会导致进程无法正常清理和关闭。因此，使用kill -9命令应该是最后的手段。</p>
<p>kill -15会向进程发送一个终止信号(SIGTERM)，通知进程要求它自行关闭。这个信号会给进程一个机会来完成清理工作和资源释放等工作。如果进程不响应，可以再使用kill -9强制终止。使用kill -15可以更加温和地关闭进程，允许进程进行清理和关闭。</p>
<h2 id="僵尸进程，孤儿进程以及其解决方式"><a href="#僵尸进程，孤儿进程以及其解决方式" class="headerlink" title="僵尸进程，孤儿进程以及其解决方式"></a>僵尸进程，孤儿进程以及其解决方式</h2><div class="table-container">
<table>
<thead>
<tr>
<th>类型</th>
<th>特点</th>
<th>解决方式</th>
</tr>
</thead>
<tbody>
<tr>
<td>僵尸进程</td>
<td>是指一个进程使用fork函数创建子进程，如果子进程退出，而父进程并没有调用wait()或者waitpid()系统调用取得子进程的终止状态，那么子进程的进程描述符仍然保存在系统中，占用系统资源</td>
<td>1.在fork子进程之后我们都要及时使用wait系统调用。2.使用kill命令</td>
</tr>
<tr>
<td>孤儿进程</td>
<td>是指一个父进程退出后，而它的一个或多个子进程还在运行，那么这些子进程将成为孤儿进程</td>
<td>init进程会定期处理</td>
</tr>
</tbody>
</table>
</div>
<p>区别:孤儿进程是父进程已退出，子进程未退出；而僵尸进程是父进程未退出，子进程已退出。</p>
<h2 id="sync和fsync"><a href="#sync和fsync" class="headerlink" title="sync和fsync"></a>sync和fsync</h2><div class="table-container">
<table>
<thead>
<tr>
<th>类型</th>
<th>特点</th>
</tr>
</thead>
<tbody>
<tr>
<td>sync</td>
<td>将文件系统缓存中的所有数据写入磁盘，包括文件数据和元数据，但并不会强制磁盘进行写入操作。这意味着，一些磁盘可能只是将数据缓存到了它们的缓冲区中，并没有真正写入磁盘。因此，使用sync命令不能完全保证数据的持久化。</td>
</tr>
<tr>
<td>fsync</td>
<td>命令将文件系统缓存中指定文件的数据写入磁盘，并强制磁盘进行写入操作。这样，fsync可以保证写入的数据已经被持久化，并可以在系统发生故障时恢复。但是，由于fsync需要等待数据写入磁盘，因此它的执行速度比sync慢。</td>
</tr>
</tbody>
</table>
</div>
<p>sync适用于在执行重要操作之前，刷新文件系统缓存；而fsync适用于在写入文件后，保证文件已经被持久化。fsync可以提供更高的数据可靠性，但是需要付出更高的性能代价。</p>
<h2 id="文件IO"><a href="#文件IO" class="headerlink" title="文件IO"></a>文件IO</h2><p>1.打开文件 fopen</p>
<p>2.fread/fwrite用于二进制读写</p>
<p>3.fscanf/fprintf 用于文本数据的读写</p>
<p>4.fseek用于移动文件指针的位置</p>

    </div>
    
    
    
    
    
    
    
</div>

                <footer id="footer">
    <div class="footer-wrap">
        <div>
            &copy;
            2022 - 2023 Waiting for the dawn
            <span class="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;Yanxin Xiang
        </div>
        <div>Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp; <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a></div>
        
    </div>
</footer>

            </div>
            </transition>
            <div id="showimg">
                <img id="showimg-content">
            </div>
        </div>
        <script src="/js/functions.js"></script>
<script src="/js/particlex.js"></script>







    </body>
</html>
